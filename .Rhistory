# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
library(broom)
library(ggplot2)
# Guardamos los residuales en un objeto
res <- residuals(lo3)
# Cargar librerías
library(dplyr)
# Lecutra del dataset
datos = read.csv("students_ai_usage.csv")
# Renombrar columnas para un mejor manejo
datos <- datos |>
rename(
edad = age,
nivel_educativo = education_level,
horas_estudio = study_hours_per_day,
usa_ia = uses_ai,
herramientas_ia = ai_tools_used,
proposito_ia = purpose_of_ai,
nota_antes = grades_before_ai,
nota_despues = grades_after_ai,
tiempo_pantalla = daily_screen_time_hours
)
# Convertimos a factor "usa_ia" para que R entienda que "Sí" y "No" son categorías, no solo texto
datos$usa_ia <- factor(datos$usa_ia, levels = c("No", "Yes"), labels = c("No", "Sí"))
# Verificamos los nuevos nombres
head(datos)
summary(datos$nota_despues)
sd(datos$nota_despues)
hist(datos$nota_despues,
col = "skyblue",
main = "Distribución de la nota después",
xlab = "Nota final")
modelo = lm(nota_despues ~ horas_estudio + usa_ia + nota_antes, data = datos)
modelo |> coef()
summary(modelo)$r.squared
summary(modelo)$adj.r.squared
library(broom)
library(ggplot2)
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
data.frame(res) |>
ggplot(aes(sample=res))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
# Gráfico de Normalidad sugerido
library(broom)
library(ggplot2)
# Usamos 'modelo' porque así aparece en tu Environment (image_310978.png)
res <- residuals(modelo)
# Generamos el gráfico sin cálculos complejos dentro para evitar el error ffi_list2
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = 15,
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(linewidth = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
library(broom)
library(ggplot2)
residuales <- modelo |> augment() |> pull(.resid)
residuales
data.frame(residuales) |>
ggplot(aes(x=residuales,))+
geom_histogram(aes(y =..density..),
bins = round(1+3.3*log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6)+
geom_density(size = 1.5)+
labs(x="Residuales",y="Densidad")+
theme_minimal()
library(broom)
library(ggplot2)
residuales <- modelo |> augment() |> pull(.resid)
residuales
# Cargar librerías
library(dplyr)
# Lecutra del dataset
datos = read.csv("students_ai_usage.csv")
# Renombrar columnas para un mejor manejo
datos <- datos |>
rename(
edad = age,
nivel_educativo = education_level,
horas_estudio = study_hours_per_day,
usa_ia = uses_ai,
herramientas_ia = ai_tools_used,
proposito_ia = purpose_of_ai,
nota_antes = grades_before_ai,
nota_despues = grades_after_ai,
tiempo_pantalla = daily_screen_time_hours
)
# Convertimos a factor "usa_ia" para que R entienda que "Sí" y "No" son categorías, no solo texto
datos$usa_ia <- factor(datos$usa_ia, levels = c("No", "Yes"), labels = c("No", "Sí"))
# Verificamos los nuevos nombres
head(datos)
modelo = lm(nota_despues ~ horas_estudio + usa_ia + nota_antes, data = datos)
modelo |> coef()
summary(modelo)$adj.r.squared
library(broom)
library(ggplot2)
residuales <- modelo |> augment() |> pull(.resid)
residuales
library(broom)
library(ggplot2)
residuales <- modelo |> augment() |> pull(.resid)
residuales
residuales |> hist(main="Histograma de los residuales",
xlab="Residuales",
ylab="Frecuencia")
library(broom)
library(ggplot2)
residuales <- modelo |> augment() |> pull(.resid)
residuales
residuales |> hist(freq=FALSE,
main="Histograma de los residuales",
xlab="Residuales",
ylab="Densidad",
col ="dodgerblue2")
residuales |> density() |> lines()
data.frame(residuales) |>
ggplot(aes(sample=res))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
data.frame(residuales) |>
ggplot(aes(sample=residuales))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
setwd("~/Regresión/TrabajoRgre/REGRESION")
data.frame(residuales) |>
ggplot(aes(sample=residuales))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
setwd("~/Regresión/TrabajoRgre/REGRESION")
data.frame(residuales) |>
ggplot(aes(sample=residuales)) +
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales") +
theme_minimal()
library(moments)
res |> agostino.test()
library(moments)
residuales |> agostino.test()
residuales |> anscombe.test()
library(broom)
library(ggplot2)
res <- modelo |> augment() |> pull(.resid)
res
residuales |> hist(freq=FALSE,
main="Histograma de los residuales",
xlab="Residuales",
ylab="Densidad",
col ="dodgerblue2")
residuales |> density() |> lines()
data.frame(res) |>
ggplot(aes(sample=res)) +
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales") +
theme_minimal()
library(broom)
library(ggplot2)
res <- modelo |> augment() |> pull(.resid)
library(broom)
library(ggplot2)
library(ggplot2)
data.frame(residuales) |>
ggplot(aes(x=residuales,))+
geom_histogram(aes(y =..density..),
bins = round(1+3.3*log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6)+
geom_density(size = 1.5)+
labs(x="Residuales",y="Densidad")+
theme_minimal()
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
library(broom)
library(ggplot2)
data.frame(residuales) |>
ggplot(aes(x=residuales,))+
geom_histogram(aes(y =..density..),
bins = round(1+3.3*log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6)+
geom_density(size = 1.5)+
labs(x="Residuales",y="Densidad")+
theme_minimal()
install.packages("rlang")
install.packages("rlang")
library(rlang)
library(broom)
library(ggplot2)
data.frame(residuales) |>
ggplot(aes(x=residuales,))+
geom_histogram(aes(y =..density..),
bins = round(1+3.3*log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6)+
geom_density(size = 1.5)+
labs(x="Residuales",y="Densidad")+
theme_minimal()
library(broom)
library(ggplot2)
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
data.frame(res) |>
ggplot(aes(sample=res))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
library(broom)
library(ggplot2)
# Usamos augment() para obtener los valores ajustados (.fitted) y los residuales (.resid)
modelo |>
augment() |>
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(size = 3, color = "steelblue", alpha = 0.7) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Valores ajustados (Puntaje de diagnóstico)",
y = "Residual",
title = "Evaluación de homocedasticidad",
subtitle = "Modelo: Desempeño académico con IA") +
theme_minimal()
# Usamos el modelo y la variable 'horas_estudio'
modelo |> augment() |>
ggplot(aes(x = horas_estudio, y = .resid)) +
geom_point(size = 3, color = "darkorange", alpha = 0.7) +
geom_hline(yintercept = 0, color = "black", linetype = "solid") +
labs(x = "Horas de estudio",
y = "Residual",
title = "Evaluación de homocedasticidad por variable",
subtitle = "Relación: Horas de estudio vs Residuales") +
theme_minimal()
# Usamos los residuales de tu modelo (res) y el total de datos
data.frame(res) |>
ggplot(aes(x = 1:nrow(datos), y = res)) +
geom_point(size = 1.5, color = "darkgreen") +
geom_line(alpha = 0.3) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Orden de observación",
y = "Residual",
title = "Evaluación de independencia",
subtitle = "Gráfico de secuencia de residuos") +
theme_minimal()
residuales |> hist(main="Histograma de los residuales",
xlab="Residuales",
ylab="Frecuencia")
plot(datos$nota_antes, datos$nota_despues,
col = "purple",
pch = 16,
xlab = "Nota antes",
ylab = "Nota después",
main = "Relación entre nota previa y nota final")
abline(lm(nota_despues ~ nota_antes, data = datos), col = "red", lwd = 2)
cor(datos$nota_antes, datos$nota_despues)
boxplot(nota_despues ~ usa_ia, data = datos,
col = c("gray80", "skyblue"),
xlab = "Uso de IA",
ylab = "Nota después",
main = "Nota final según uso de IA")
tapply(datos$nota_despues, datos$usa_ia, mean)
modelo = lm(nota_despues ~ horas_estudio + usa_ia + nota_antes, data = datos)
modelo |> coef()
summary(modelo)$r.squared
library(broom)
library(ggplot)
library(broom)
library(ggplot2)
# Usamos augment() para obtener los valores ajustados (.fitted) y los residuales (.resid)
modelo |>
augment() |>
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(size = 3, color = "steelblue", alpha = 0.7) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Valores ajustados (Puntaje de diagnóstico)",
y = "Residual",
title = "Evaluación de homocedasticidad",
subtitle = "Modelo: Desempeño académico con IA") +
theme_minimal()
setwd("~/Regresión/TrabajoRgre/REGRESION")
# Usamos augment() para obtener los valores ajustados (.fitted) y los residuales (.resid)
modelo |>
augment() |>
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(size = 3, color = "steelblue", alpha = 0.5) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Valores ajustados (Puntaje de diagnóstico)",
y = "Residual",
title = "Evaluación de homocedasticidad",
subtitle = "Modelo: Desempeño académico con IA") +
theme_minimal()
modelo = lm(nota_despues ~ horas_estudio + usa_ia + nota_antes, data = datos)
modelo |> coef()
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
remove.packages(c("ggplot2", "rlang", "vctrs"))
remove.packages(c("ggplot2", "rlang"))
remove.packages(c("ggplot2", "rlang"))
install.packages(c("ggplot2", "rlang", "vctrs"))
install.packages(c("ggplot2", "rlang", "vctrs"))
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
install.packages(c("ggplot2", "rlang", "vctrs"))
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
library(rlang)
library(ggplot2)
library(vctrs)
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
data.frame(res) |>
ggplot(aes(sample=res))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
library(moments)
res |> agostino.test()
res |> anscombe.test()
res |> shapiro.test()
modelo |> plot(which=1)
modelo |> plot(which=3)
# Usamos augment() para obtener los valores ajustados (.fitted) y los residuales (.resid)
modelo |>
augment() |>
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(size = 3, color = "steelblue", alpha = 0.5) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Valores ajustados (Puntaje de diagnóstico)",
y = "Residual",
title = "Evaluación de homocedasticidad",
subtitle = "Modelo: Desempeño académico con IA") +
theme_minimal()
library(broom)
# Usamos augment() para obtener los valores ajustados (.fitted) y los residuales (.resid)
modelo |>
augment() |>
ggplot(aes(x = .fitted, y = .resid)) +
geom_point(size = 3, color = "steelblue", alpha = 0.5) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Valores ajustados (Puntaje de diagnóstico)",
y = "Residual",
title = "Evaluación de homocedasticidad",
subtitle = "Modelo: Desempeño académico con IA") +
theme_minimal()
# Usamos el modelo y la variable 'horas_estudio'
modelo |> augment() |>
ggplot(aes(x = horas_estudio, y = .resid)) +
geom_point(size = 3, color = "darkorange", alpha = 0.7) +
geom_hline(yintercept = 0, color = "black", linetype = "solid") +
labs(x = "Horas de estudio",
y = "Residual",
title = "Evaluación de homocedasticidad por variable",
subtitle = "Relación: Horas de estudio vs Residuales") +
theme_minimal()
library(car)
modelo |> ncvTest()
# Usamos los residuales de tu modelo (res) y el total de datos
data.frame(res) |>
ggplot(aes(x = 1:nrow(datos), y = res)) +
geom_point(size = 1.5, color = "darkgreen") +
geom_line(alpha = 0.3) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(x = "Orden de observación",
y = "Residual",
title = "Evaluación de independencia",
subtitle = "Gráfico de secuencia de residuos") +
theme_minimal()
library(ggfortify)
# Usamos los residuales de tu modelo
res |>
TSA::acf(lag = 18, plot = F) |>
autoplot() +
labs(x = "Desfase (Lag)",
y = "Autocorrelación",
title = "Evaluación de independencia (ACF)",
subtitle = "Gráfico de Autocorrelación de los Residuales") +
theme_minimal()
library(car)
modelo |>
durbinWatsonTest(alternative = "two.sided",
max.lag = 10,
reps = 1e5)
# Guardamos los residuales en un objeto
res <- residuals(modelo)
# Gráfico de Normalidad sugerido
data.frame(res) |>
ggplot(aes(x = res)) +
geom_histogram(aes(y = ..density..),
bins = round(1 + 3.3 * log10(nrow(datos))),
fill = "dodgerblue2",
alpha = 0.6) +
geom_density(size = 1.2, color = "darkblue") +
labs(title = "Distribución de Residuales",
subtitle = "Histograma con curva de densidad",
x = "Residuales",
y = "Densidad") +
theme_minimal()
data.frame(res) |>
ggplot(aes(sample=res))+
stat_qq(size = 2) +
stat_qq_line(distribution = stats::qnorm)+
labs(x = "Cuantil teórico", y = "Residuales")+
theme_minimal()
